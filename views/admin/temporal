<?php

use yii\web\View;
$this->title="Dashboard";

$this->params['classBody'] = "site-navbar-small app-media page-aside-left dashboard-admin";

$this->registerJsFile(
    '@web/webAssets/js/admin/index.js',
    ['depends' => [\app\assets\AppAssetClassicTopBar::className()]]
);


$this->registerJsFile(
  '@web/webAssets/templates/classic/global/vendor/d3/d3.min.js',
  ['depends' => [\app\assets\AppAsset::className()]]
);

$this->registerJsFile(
  '@web/webAssets/templates/classic/global/vendor/c3/c3.min.js',
  ['depends' => [\app\assets\AppAsset::className()]]
);

$this->registerCssFile(
  '@web/webAssets/css/admin/index.css',
  ['depends' => [\app\assets\AppAsset::className()]]
);

$this->registerCssFile(
  '@web/webAssets/templates/classic/global/vendor/c3/c3.css',
  ['depends' => [\app\assets\AppAsset::className()]]
);
?>
<div class="page">
<!-- Media Sidebar -->
<div class="page-aside">
  <div class="page-aside-switch">
    <i class="icon wb-chevron-left" aria-hidden="true"></i>
    <i class="icon wb-chevron-right" aria-hidden="true"></i>
  </div>
  <div class="page-aside-inner page-aside-scroll">
    <div data-role="container">
      <div data-role="content">
        <section class="page-aside-section">
          <h5 class="page-aside-title">Reportes</h5>
          <div class="list-group">
            <a class="list-group-item" href="javascript:void(0)"><i class="icon wb-pluse" aria-hidden="true"></i>Niveles</a>
            <a class="list-group-item" href="javascript:void(0)"><i class="icon fa-users" aria-hidden="true"></i>Por empleado</a>
            <a class="list-group-item" href="javascript:void(0)"><i class="icon fa-bolt" aria-hidden="true"></i>Por competencia</a>
          </div>
        </section>
        
      </div>
    </div>
  </div>
</div>
<!-- Media Content -->
<div class="page-main">
  <!-- Media Content Header -->
  <div class="page-header">
    <h1 class="page-title">Dashboard</h1>
    <div class="page-header-actions">
        <button class="btn btn-success float-right ladda-button" id="js-enviar-email" data-style="zoom-in">
            <span class="ladda-label">
                Enviar evaluaciones
                <i class="icon fa-send" aria-hidden="true"></i>
            </span>
            
        </button>
    </div>
  </div>
  <!-- Media Content -->
  <div id="mediaContent" class="page-content page-content-table">
  <div class="col-md-12">
  <div class="example-wrap">
    <div class="nav-tabs-horizontal nav-tabs-inverse nav-tabs-animate" data-plugin="tabs">
      <ul class="nav nav-tabs nav-tabs-solid" role="tablist">
        <?php
        $active = true;
        foreach($resultados as $index=>$resultado){
        ?>
        <li class="nav-item" role="presentation">
          <a class="nav-link <?=$active?'active':''?>" data-toggle="tab" href="#nivel-<?=$index?>"
          aria-controls="exampleTabsAnimateSlideLeftOne" role="tab" aria-expanded="true">
          Nivel <?=$resultado['nombre_nivel']?>
          </a>
        </li>

        <?php
        $active = false;
        }
        ?>

      </ul>
      <div class="tab-content">

      <?php
        $active = true;
        foreach($resultados as $index=>$resultado){
        ?>

        <div class="tab-pane <?=$active?'active':''?> animation-slide-left" id="nivel-<?=$index?>"
        role="tabpanel">

          <?php
          foreach($resultado["cuestionarios"] as $cuestionario){
          ?>  
          <div class="panel">
            <div class="panel-body">

              <section>
                <h6 class="panel-title">
                  <?=$cuestionario["nombre_cuestionario"]?>
                </h6>
                <div class="row">
                  <div class="col-md-6">
                    <?php
                    $preguntaT = '';
                    $index = 0;
                    $preguntaV = '';
                    foreach($cuestionario['preguntas'] as $keys=>$pregunta){

                      if ($pregunta === end($cuestionario['preguntas'])) {
                        $preguntaT .= '"Pregunta '.++$index.'"';
                        $preguntaV .= $pregunta['promedio']."";
                      }else{
                        $preguntaT .= '"Pregunta '.++$index.'",';
                        $preguntaV .= $pregunta['promedio'].",";
                      }
                      
                    ?>
                    <div class="row">
                      <div class="col-md-12">
                        <p>
                            <?=$pregunta["texto_pregunta"]?>
                        </p>
                      </div>
                    </div>
                    
                    <?php
                    }
                    ?>
                  </div>
                
                  <div class="col-md-6">
                    <div id="chart<?=$cuestionario["identificador"]?>">

                    </div>

                    <?php
                    $this->registerJs(
                      "var simple_line_chart = c3.generate({
                        bindto: '#chart".$cuestionario["identificador"]."',
                        data: {
                          x: 'x',
                          columns: [
                            ['x', 'hola'],
                            ['Preguntas', 5]
                          ],
                          type:'bar'
                        },
                        color: {
                          pattern: [Config.colors('primary', 600), Config.colors('green', 600)]
                        },
                        axis: {
                          x: {
                            tick: {
                              outer: false
                            }
                          },
                          y: {
                            max: 300,
                            min: 0,
                            tick: {
                              outer: false,
                              count: 7,
                              values: [0, 50, 100, 150, 200, 250, 300]
                            }
                          }
                        },
                        grid: {
                          x: {
                            show: false
                          },
                          y: {
                            show: true
                          }
                        }
                      });",
                      View::POS_READY,
                      $cuestionario["identificador"]
                    );
                    ?>
                    </div>
                </div>
              </section>
            </div>
          </div>
          <?php
          }
          ?>

        </div>

        <?php
        $active = false;
        }
        ?>
        
      </div>
    </div>
  </div>
</div>
  </div>
</div>
</div>
